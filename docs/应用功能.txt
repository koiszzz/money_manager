一、版本范围（Final V1）

单机本地版：无登录、无云同步、无任何联网能力
单用户使用：不支持多人协作
平台建议：iOS / Android（本地数据库 SQLite）
本地能力：通知提醒、文件导入导出、应用锁
二、全局交互规则（所有页面通用）

底部导航：首页 / 账单 / 记一笔(悬浮按钮) / 报表 / 预算 / 设置
时间口径：所有统计按“账单发生时间”计算
金额显示：收入为正向样式、支出为负向样式、转账中性样式
数据一致性：新增/编辑/删除账单后，实时刷新首页汇总、报表、预算、账户余额
返回逻辑：从列表进详情，返回原筛选和滚动位置保持不变
删除保护：删除动作均二次确认，可提供短时撤销（3~5 秒 Toast）
三、页面级详细说明

1) 启动页 / 应用锁页

展示内容：
启动 Logo（1~2 秒）
若开启应用锁，进入 PIN/生物识别验证页
交互逻辑：
启动后判断是否开启应用锁
验证成功进入首页；失败可重试，超过阈值触发冷却
忘记 PIN：提示“清除本地数据后重置”（避免后门）
2) 首页（Dashboard）

展示内容：
顶部月份切换（< 2026年02月 >）
汇总卡片：本月收入 / 支出 / 结余
预算卡片：总预算、已用比例、剩余金额、超支标记
最近账单列表（默认最近 10 条）
交互逻辑：
左右切换月份，所有卡片与列表联动刷新
点击“收入/支出/结余”卡片 → 跳转账单页并自动带筛选条件
点击预算卡片 → 跳转预算页
点击最近账单某条 → 账单详情页
点击“+记一笔” → 打开记一笔页（默认支出）
3) 记一笔页（核心流程）

展示内容：
顶部切换：支出 | 收入 | 转账
金额输入区（数字键盘）
分类区（网格）
字段区：账户、时间、备注、标签（转账时为“转出账户/转入账户”）
底部按钮：保存、保存并再记一笔
交互逻辑：
默认聚焦金额，输入后才允许保存
支出/收入：必须选择分类与账户
转账：必须选择转出和转入账户，且两者不能相同
时间默认“当前时间”，可改成历史时间（补记）
保存成功后：
保存：返回来源页并刷新
保存并再记一笔：清空金额，保留上次分类和账户（提升效率）
异常校验：
金额 <= 0 禁止保存
信用卡还款可作为“转账特例”处理（转到信用卡账户）
4) 账单页（列表 + 筛选）

展示内容：
顶部：月份选择、搜索入口、筛选入口
列表：按日期分组（如 今天 / 昨天 / 2月18日）
每条：分类图标、分类名、备注、账户、金额
交互逻辑：
上拉加载当月更多记录（若分页）
搜索支持：备注关键词、金额（精确/区间）
筛选维度：类型、分类、账户、标签、金额区间
点击账单 → 账单详情页
左滑操作：删除 / 复制
删除后：
立即从列表移除
回算账户余额、预算、统计
提供撤销入口（可选）
5) 账单详情/编辑页

展示内容：
全字段展示：类型、金额、分类、账户、时间、备注、标签
底部操作：保存修改、删除、复制为新账单
交互逻辑：
任意字段可编辑；类型切换时动态切换字段（如转账字段）
保存修改后回到来源列表，保持原筛选
删除需二次确认
复制为新账单：进入记一笔页并预填字段，用户确认后保存
6) 报表页

展示内容：
时间维度切换：月 / 年
图表模块：
支出分类饼图
收支趋势图（按日/按月）
分类排行（金额、占比）
交互逻辑：
切换月份/年份，全部图表联动刷新
点击饼图某分类 → 跳到账单页并自动筛选该分类
点击趋势图某点 → 打开对应日期账单列表
空数据场景展示“去记一笔”引导按钮
7) 预算页

展示内容：
总预算卡：预算总额、已用、剩余、使用进度
分类预算列表：每类预算、已用、剩余、状态（正常/预警/超支）
交互逻辑：
首次进入无预算：引导“设置本月总预算”
设置/编辑总预算后立即生效
分类预算可单独开关（不设即不限制）
预警阈值（如 80%）可配置
超支触发本地通知（若授权）
月切换时读取对应月份预算，不自动继承（V1 简化）
8) 设置页（含二级功能）

展示内容：

模块入口：账户管理、分类标签、周期记账、提醒设置、数据备份恢复、显示与安全、关于
交互逻辑（按二级页）：

设置页（二级页面完整补充）

账户管理

展示：账户列表（名称、类型、当前余额、是否启用）、总资产汇总
功能：新增/编辑/删除/启用禁用账户；账户排序
交互：
新增时必填 名称、类型、初始余额
删除账户前检查关联账单：有数据则提示“先迁移或禁用”
禁用账户后不可用于新记账，历史账单仍可查看
账户迁移（建议从账户管理进入）

展示：源账户、目标账户、迁移数量预览
功能：将某账户历史账单批量迁移到另一个账户
交互：
选择源/目标后展示影响条数
二次确认后执行，不可逆（建议先提示备份）
完成后回算账户余额与报表数据
分类与标签管理

展示：支出分类、收入分类、标签列表；分类排序状态
功能：新增/编辑/删除（或禁用）分类；标签增删改
交互：
删除分类时若有关联账单，改为“禁用”优先
可将旧分类合并到新分类（批量改历史）
标签支持颜色与快速搜索
周期记账

展示：周期任务列表（金额、频率、下一次执行、状态）
功能：新增任务、编辑规则、暂停/恢复、删除
交互：
规则支持每日/每周/每月/自定义间隔
到期生成“待确认账单”，用户确认后入账
若账户不可用（禁用/不存在）则标记异常并引导修复
提醒设置

展示：每日记账提醒、预算预警、周期账单提醒、提醒时间、免打扰时段
功能：本地通知开关与时间配置
交互：
首次开启时请求系统通知权限
未授权则展示引导去系统设置
免打扰生效后，提醒延后到下一可提醒时段
数据备份与恢复

展示：最近备份时间、备份文件列表（可选）、导出/导入入口
功能：手动导出备份、导入恢复、覆盖恢复
交互：
导出：生成本地文件（建议含时间戳）
导入：先做文件校验（格式/版本/完整性）
恢复前强提醒“将覆盖当前数据”，需二次确认
数据清理

展示：缓存大小、附件大小（如后续支持小票图片）
功能：清理缓存、清理临时文件、清空全部数据
交互：
清理缓存不影响账单核心数据
清空全部数据需多重确认（弹窗 + 输入确认词/PIN）
清空后回到首次使用状态
显示与本地化

展示：主题模式、字体大小、货币符号、小数位、周起始日
功能：界面个性化配置
交互：
修改后即时预览
货币符号仅影响显示，不改历史金额数值
周起始日影响报表按周聚合口径
安全与隐私

展示：应用锁开关（PIN/生物识别）、截屏保护（安卓可选）、隐私说明
功能：开启应用锁、修改 PIN、关闭锁
交互：
开启应用锁需先完成 PIN 设置
关闭应用锁需验证当前 PIN/生物识别
多次验证失败触发短时锁定
导出报表

展示：导出范围（月/年/自定义）、导出类型（CSV）
功能：本地导出账单明细与汇总报表
交互：
先选时间范围再导出
导出成功后支持系统分享/保存到文件
文件命名规则统一（如 ledger_2026-02.csv）
关于与支持

展示：版本号、更新日志、本地使用说明、隐私条款（离线版）
功能：查看版本信息、复制设备诊断信息（本地）
交互：
点击版本号可展开构建信息
诊断信息不含账单明文（仅设备与应用状态）

四、核心业务对象（用于研发对齐）

账单：id, type(支出/收入/转账), amount, categoryId, accountId, transferInAccountId, occurredAt, note, tags, createdAt, updatedAt
账户：id, name, type(现金/借记卡/信用卡), balance, billingDay, repaymentDay, enabled
预算：id, month, totalAmount, warningThreshold
分类：id, type(支出/收入), name, icon, sort, enabled
周期任务：id, templateBill, rule, nextRunAt, autoGenerate, enabled
五、关键计算规则（必须统一）

收支统计：
收入总额 = 所有收入账单金额之和
支出总额 = 所有支出账单金额之和
结余 = 收入 - 支出
转账：
不进入收入/支出统计
转出账户余额减少，转入账户余额增加
预算消耗：
仅支出账单参与预算计算（收入、转账不计）
时间归属：
账单归属月份 = occurredAt 所在自然月
编辑影响：
若修改金额/类型/时间/账户，需先冲销旧影响，再应用新影响
六、V1 验收清单（上线前）

能在离线环境完整使用全部核心功能
新增/编辑/删除账单后，各页面统计一致
切月后首页/报表/预算数据一致
本地备份导出、恢复可用且数据完整
应用锁、通知权限、异常输入校验均正常